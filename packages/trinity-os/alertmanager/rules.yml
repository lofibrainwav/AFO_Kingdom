# AFO Kingdom Alertmanager Rules
# ÁúûÂñÑÁæéÂ≠ùÊ∞∏ - Perpetual Governance Alerts

groups:
  - name: trinity_governance
    rules:
      # ÂñÑ (Goodness) - Trinity Score Critical
      - alert: TrinityScoreCritical
        expr: trinity_score < 80
        for: 1m
        labels:
          severity: critical
          pillar: "ÂñÑ"
        annotations:
          summary: "Trinity Score Critical ({{ $value }}%)"
          description: "Trinity Score has dropped below 80%. Immediate review required."
          discord_message: "üõë **CRITICAL**: Trinity Score {{ $value }}% - ÂñÑ (Goodness) Violation"

      # ÂñÑ (Goodness) - Risk Score Alert
      - alert: RiskScoreHigh
        expr: risk_score > 20
        for: 30s
        labels:
          severity: critical
          pillar: "ÂñÑ"
        annotations:
          summary: "Risk Score High ({{ $value }}%)"
          description: "Risk Score exceeds 20%. Security review required."
          discord_message: "üö® **RISK ALERT**: Risk Score {{ $value }}% - Immediate action required"

      # Â≠ù (Serenity) - Latency Warning
      - alert: HighLatency
        expr: http_request_duration_seconds{quantile="0.95"} > 2
        for: 2m
        labels:
          severity: warning
          pillar: "Â≠ù"
        annotations:
          summary: "High Latency Detected ({{ $value }}s)"
          description: "95th percentile latency exceeds 2 seconds. Performance degradation."
          discord_message: "‚ö†Ô∏è **WARNING**: High latency {{ $value }}s - Â≠ù (Serenity) affected"

      # Â≠ù (Serenity) - Cache Hit Rate
      - alert: LowCacheHitRate
        expr: cache_hit_rate < 0.5
        for: 5m
        labels:
          severity: warning
          pillar: "Â≠ù"
        annotations:
          summary: "Low Cache Hit Rate ({{ $value }})"
          description: "Cache hit rate below 50%. Consider cache optimization."

      # Ê∞∏ (Eternity) - Service Down
      - alert: ServiceDown
        expr: up == 0
        for: 1m
        labels:
          severity: critical
          pillar: "Ê∞∏"
        annotations:
          summary: "Service {{ $labels.job }} is Down"
          description: "Service has been down for more than 1 minute."
          discord_message: "üíÄ **SERVICE DOWN**: {{ $labels.job }} - Ê∞∏ (Eternity) compromised"

      # Áúû (Truth) - Test Failure
      - alert: TestFailure
        expr: test_success_rate < 0.95
        for: 5m
        labels:
          severity: warning
          pillar: "Áúû"
        annotations:
          summary: "Test Success Rate Low ({{ $value }})"
          description: "Test success rate below 95%. Code quality may be affected."
